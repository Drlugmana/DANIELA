# Script SOLO para ver valores de variables

$dtLogs = Exec-SQLQuery "ECBPPRQ23,11423" $querySQLLogs

foreach ($drLogs in $dtLogs)
{
    $instancia = $drLogs["Instancia"]

    Write-Host "------------------------------------" -ForegroundColor DarkGray
    Write-Host "Instancia desde SQLdm:" $instancia -ForegroundColor Cyan

    $queryInstancias = @"
select 
    concat(MachineName,trim(InstanceName),PortNumber) as Instancia1,
    concat(MachineName,InstanceName) as Instancia2
from Administracion_DB.dbo.connectlist
where Engine = 'S'
  and Status <> 'A'
  and concat(MachineName,InstanceName) = '$instancia'
"@

    $dtInsAUX = Exec-SQLQuery "ECBPPRQ23,11423" $queryInstancias

    foreach ($insAux in $dtInsAUX)
    {
        Write-Host "Instancia1 (para conexión):" $insAux["Instancia1"] -ForegroundColor Yellow
        Write-Host "Instancia2 (nombre lógico):" $insAux["Instancia2"] -ForegroundColor Green
    }
}
